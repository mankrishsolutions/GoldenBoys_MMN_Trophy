<!DOCTYPE html>
<html>
<head>
<title>Team Details</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<!-- TOP HEADER WITH LOGO -->
<div class="header-banner d-flex flex-column align-items-center justify-content-center text-white">
    <img src="GoldenBoys.jpg" class="header-logo mb-2">
    <h2 class="m-0 fw-bold">MMN Golden Boys Champions League</h2>
</div>
<style>
.header-banner {
    background: linear-gradient(90deg, #005BEA, #00C6FB);
    padding: 20px;
    text-align: center;
}
.header-logo {
    width: 120px;
    border-radius: 10px;
    box-shadow: 0px 2px 8px rgba(0,0,0,0.4);
}
</style>

<div class="container my-4">




<a href="adminDashboard.html" class="btn btn-secondary mb-3">⬅ Back to Admin</a>

<h3 id="teamTitle"></h3>
<hr>

<div id="captainBox" class="mb-3"></div>
<div id="paymentBox" class="mb-3"></div>

<h4>Players</h4>

<div class="table-responsive">
<table class="table table-bordered">
<thead class="table-dark">
<tr>
  <th>#</th>
  <th>Player Name</th>
  <th>Age</th>
  <th>Mobile</th>
  <th>Aadhaar</th>
  <th>Aadhaar Image</th>
</tr>
</thead>
<tbody id="playersTable"></tbody>
</table>
</div>

<button id="pdfBtn" class="btn btn-success mt-3">Download PDF</button>

<script>
const apiURL = "https://script.google.com/macros/s/AKfycbwxmyNE0hsdZaWynzebm1enPzssfdtqox0whmy_ZbuBBP2K1R0JF13JVV-UHkvxY5HRJQ/exec";
const team = new URLSearchParams(window.location.search).get("team");

document.getElementById("teamTitle").innerText = team;

async function loadTeam() {

  // TEAM DETAILS
  const dres = await fetch(apiURL + "?action=getTeamDetails&team=" + encodeURIComponent(team));
  const d = await dres.json();

  document.getElementById("captainBox").innerHTML = `
    <h5>Captain Details</h5>
    <p>${d.captainName} (${d.captainMobile})</p>
  `;

  document.getElementById("paymentBox").innerHTML = `
    <h5>Payment</h5>
    <p>Status: ${d.paymentStatus}</p>
    <p>Amount: ₹${d.paymentAmount}</p>
    ${ d.paymentScreenshot ? `<img src="${d.paymentScreenshot}" style="max-width:250px;border:1px solid #ccc;cursor:pointer" onclick="window.open('${d.paymentScreenshot}')">` : "" }
  `;

  // PLAYERS
  const pres = await fetch(apiURL + "?action=getTeamPlayers&team=" + encodeURIComponent(team));
  const players = await pres.json();

  const tbody = document.getElementById("playersTable");
  tbody.innerHTML = "";

  players.forEach((p,i)=>{
    tbody.innerHTML += `
      <tr>
        <td>${i+1}</td>
        <td>${p.playerName}</td>
        <td>${p.age}</td>
        <td>${p.mobile}</td>
        <td>${p.aadhaar}</td>
        <td>
          ${p.aadhaarImage ? `<img src="${p.aadhaarImage}" style="width:70px;height:70px;object-fit:cover;cursor:pointer" onclick="window.open('${p.aadhaarImage}')">` : "-"}
        </td>
      </tr>
    `;
  });
}

loadTeam();

document.getElementById("pdfBtn").onclick = async () => {
  const r = await fetch(apiURL + "?action=generateTeamPdf&team=" + encodeURIComponent(team));
  const j = await r.json();
  window.open(j.pdfUrl, "_blank");
};
</script>

</div>
</body>
</html>
