<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Team Details – MMN Golden Boys</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#005BEA">

    <style>
        body {
            background: #f4f6f9;
            font-family: "Segoe UI", sans-serif;
            padding: 20px;
        }

        .main-card {
            max-width: 1100px;
            margin: auto;
            border-radius: 18px;
            box-shadow: 0 12px 35px rgba(0,0,0,0.15);
            overflow: hidden;
            background: white;
        }

        .header-banner {
            background: linear-gradient(90deg, #005BEA, #00C6FB);
            padding: 22px 15px;
            text-align: center;
            color: white;
        }

        .header-logo {
            width: 100px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.4);
            margin-bottom: 8px;
        }

        .info-row span {
            margin-right: 25px;
            font-weight: 500;
        }
    </style>
</head>
<body>

<div class="main-card">

    <!-- HEADER -->
    <div class="header-banner">
        <img src="GoldenBoys.jpg" class="header-logo">
        <h5 class="fw-bold mb-0">MMN Golden Boys</h5>
        <small>Champions League</small>
    </div>

    <!-- BODY -->
    <div class="card-body p-4">

        <!-- TOP BAR -->
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h4 class="fw-bold mb-0" id="teamTitle"></h4>

            <button class="btn btn-outline-secondary btn-sm"
                    onclick="window.location.assign('adminDashboard.html')">
                ← Back
            </button>
        </div>

        <hr>

        <!-- CAPTAIN + PAYMENT (ONE LINE) -->
        <div class="info-row mb-3">
            <span id="captainBox"></span>
            <span id="paymentBox"></span>
        </div>

        <h5 class="mt-4 mb-3">Players</h5>

        <!-- PLAYERS TABLE -->
        <div class="table-responsive">
            <table class="table table-bordered align-middle">
                <thead class="table-dark">
                <tr>
                    <th>#</th>
                    <th>Player</th>
                    <th>Age</th>
                    <th>Mobile</th>
                    <th>Aadhaar</th>
                    <th>Aadhaar Image</th>
                    <th>Player Photo</th>
                </tr>
                </thead>
                <tbody id="playersTable"></tbody>
            </table>
        </div>

        <button id="pdfBtn" class="btn btn-success mt-3">
            Download Team PDF
        </button>
    </div>
</div>

<script>
const apiURL = "https://script.google.com/macros/s/AKfycbwE-fiDQn2TzNlDSNLi4m42J6f9lZQcoJZ20Kc8fDKJd3ejt8MPhozOXqn3_YRHJ9Ovdw/exec";
const team = new URLSearchParams(window.location.search).get("team");

document.getElementById("teamTitle").innerText = team;

async function loadTeam() {

    // TEAM DETAILS
    const d = await (await fetch(apiURL + "?action=getTeamDetails&team=" + encodeURIComponent(team))).json();

    document.getElementById("captainBox").innerHTML =
        `Captain: ${d.captainName} (${d.captainMobile})`;

    document.getElementById("paymentBox").innerHTML =
        `Payment: ${d.paymentStatus} | ₹${d.paymentAmount}`;

    // PLAYERS
    const players = await (await fetch(apiURL + "?action=getTeamPlayers&team=" + encodeURIComponent(team))).json();

    const tbody = document.getElementById("playersTable");
    tbody.innerHTML = "";

    players.forEach((p, i) => {
        tbody.innerHTML += `
        <tr>
            <td>${i + 1}</td>
            <td>${p.playerName}</td>
            <td>${p.age}</td>
            <td>${p.mobile}</td>
            <td>${p.aadhaar}</td>

            <td class="text-center">
                ${p.aadhaarImage
                    ? `<a href="${p.aadhaarImage}" target="_blank" class="btn btn-sm btn-outline-primary">View</a>`
                    : "-"}
            </td>

            <td class="text-center">
                ${p.playerImage
                    ? `<a href="${p.playerImage}" target="_blank" class="btn btn-sm btn-outline-success">View</a>`
                    : "-"}
            </td>
        </tr>`;
    });
}

loadTeam();

document.getElementById("pdfBtn").onclick = async () => {
    const j = await (await fetch(apiURL + "?action=generateTeamPdf&team=" + encodeURIComponent(team))).json();
    window.open(j.pdfUrl, "_blank");
};
</script>

<script>
if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
}
</script>
<script src="app.js?v=20251213"></script>
</body>
</html>
